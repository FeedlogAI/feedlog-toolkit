{"version":3,"file":"feedlog-github-issues-sdk.js","sourceRoot":"","sources":["../../../src/components/feedlog-github-issues-sdk/feedlog-github-issues-sdk.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Prop, Event, EventEmitter, h, State } from '@stencil/core';\nimport { FeedlogSDK, GitHubIssue } from '@feedlog-toolkit/core';\n\n/**\n * Feedlog GitHub Issues SDK Component\n *\n * A component for displaying GitHub issues fetched using the Feedlog SDK.\n * This component uses the SDK internally to fetch data and delegates to the base component for rendering.\n */\n@Component({\n  tag: 'feedlog-github-issues-sdk',\n  shadow: true,\n})\nexport class FeedlogGithubIssuesSdk {\n  /**\n   * API key (public key) for the Feedlog SDK\n   */\n  @Prop() pk!: string;\n\n  /**\n   * Array of repository IDs (e.g., ['owner/repo']) or JSON string\n   */\n  @Prop() repos?: string[] | string;\n\n  /**\n   * Maximum width of the container\n   */\n  @Prop() maxWidth: string = '56rem';\n\n  /**\n   * Theme variant: 'light' or 'dark'\n   */\n  @Prop() theme: 'light' | 'dark' = 'light';\n\n  /**\n   * Event emitted when an issue is upvoted\n   */\n  @Event() feedlogUpvote!: EventEmitter<number>;\n\n  @State() issues: GitHubIssue[] = [];\n  @State() loading: boolean = true;\n  @State() error: string | null = null;\n\n  private sdk: FeedlogSDK | null = null;\n  private previousPk?: string;\n  private previousRepos?: string[] | string;\n\n  componentWillLoad() {\n    this.previousPk = this.pk;\n    this.previousRepos = this.repos;\n    this.initializeSDK();\n    this.fetchIssues();\n  }\n\n  componentDidUpdate() {\n    // Re-fetch if pk or repos changed\n    const pkChanged = this.previousPk !== this.pk;\n    const reposChanged = JSON.stringify(this.previousRepos) !== JSON.stringify(this.repos);\n\n    if (pkChanged || reposChanged) {\n      if (pkChanged) {\n        this.initializeSDK();\n      }\n      this.fetchIssues();\n      this.previousPk = this.pk;\n      this.previousRepos = this.repos;\n    }\n  }\n\n  private initializeSDK() {\n    if (!this.pk) {\n      this.error = 'API key (pk) is required';\n      this.loading = false;\n      return;\n    }\n\n    this.sdk = new FeedlogSDK(this.pk);\n  }\n\n  private parseRepos(): string[] {\n    if (!this.repos) {\n      return [];\n    }\n\n    if (typeof this.repos === 'string') {\n      try {\n        const parsed = JSON.parse(this.repos);\n        return Array.isArray(parsed) ? parsed : [];\n      } catch {\n        // If not valid JSON, treat as single repo string\n        return [this.repos];\n      }\n    }\n\n    return Array.isArray(this.repos) ? this.repos : [];\n  }\n\n  private async fetchIssues() {\n    if (!this.sdk) {\n      return;\n    }\n\n    const repos = this.parseRepos();\n\n    if (repos.length === 0) {\n      this.error = 'At least one repository is required';\n      this.loading = false;\n      return;\n    }\n\n    try {\n      this.loading = true;\n      this.error = null;\n      this.issues = await this.sdk.fetchIssues(repos);\n    } catch (err) {\n      this.error = err instanceof Error ? err.message : 'Failed to fetch issues';\n      this.issues = [];\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  private handleUpvote = (event: CustomEvent<number>) => {\n    this.feedlogUpvote.emit(event.detail);\n  };\n\n  render() {\n    return (\n      <feedlog-github-issues-base\n        issues={this.issues}\n        maxWidth={this.maxWidth}\n        theme={this.theme}\n        loading={this.loading}\n        error={this.error}\n        onFeedlogUpvote={this.handleUpvote}\n      ></feedlog-github-issues-base>\n    );\n  }\n}\n"]}